<template>
    <div class="search-card">
        <div class="search-header">
            <lightning-icon icon-name="standard:search" size="small" class="header-icon"></lightning-icon>
            <h2 class="header-title">Profile Explorer (Unified Profiles)</h2>
        </div>
        
        <div class="search-content">
            
            <!-- BÃºsqueda Inteligente Global -->
            <div class="search-box-container">
                <div class="search-input-wrapper">
                    <lightning-input 
                        type="search" 
                        label="Patient Search"
                        placeholder="Search by Name, Email, POS ID or Code..." 
                        onchange={handleSearchChange}
                        oncommit={handleSearchAction}
                        value={searchTerm}
                        class="custom-search-input">
                    </lightning-input>
                </div>
                <div class="search-button-container">
                    <lightning-button 
                        label="Search Profiles" 
                        variant="brand" 
                        onclick={handleSearchAction} 
                        disabled={isSearchDisabled}
                        icon-name="utility:search"
                        class="search-button">
                    </lightning-button>
                </div>
            </div>

            <!-- Tabla de Resultados -->
            <template if:true={hasResults}>
                <div class="results-section">
                    <div class="results-table-wrapper">
                        <lightning-datatable
                            key-field="ssot__Id__c"
                            data={searchResults}
                            columns={columns}
                            max-row-selection="1"
                            onrowselection={handleRowSelection}
                            class="custom-datatable">
                        </lightning-datatable>
                    </div>
                </div>
            </template>

            <template if:true={noResults}>
                <div class="no-results-message">
                    <lightning-icon icon-name="utility:info" size="small" class="info-icon"></lightning-icon>
                    <span>No se encontraron perfiles para los criterios seleccionados.</span>
                </div>
            </template>

            <template if:true={isSearching}>
                <div class="spinner-container">
                    <lightning-spinner alt-text="Searching..." size="medium"></lightning-spinner>
                </div>
            </template>
        </div>
    </div>
</template>