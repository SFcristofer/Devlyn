<template>
    <div class="search-card">
        <div class="search-header">
            <lightning-icon icon-name="standard:search" size="small" class="header-icon"></lightning-icon>
            <h2 class="header-title">Profile Explorer (Unified Profiles)</h2>
        </div>
        
        <div class="search-content">
            
            <!-- Flujo de SelecciÃ³n Estilo Data Cloud -->
            <div class="search-filters">
                <div class="filter-item">
                    <lightning-combobox
                        label="Select Data Space"
                        value={selectedDataSpace}
                        options={dataSpaceOptions}
                        onchange={handleDataSpaceChange}
                        placeholder="default"
                        class="custom-combobox">
                    </lightning-combobox>
                </div>
                <div class="filter-item">
                    <lightning-combobox
                        label="Select an option"
                        value={selectedObject}
                        options={objectOptions}
                        onchange={handleObjectChange}
                        placeholder="Select Object"
                        class="custom-combobox">
                    </lightning-combobox>
                </div>
                <div class="filter-item">
                    <lightning-combobox
                        label="Select attribute"
                        value={selectedAttribute}
                        options={attributeOptions}
                        onchange={handleAttributeChange}
                        disabled={isAttributeDisabled}
                        placeholder="Select Attribute"
                        class="custom-combobox">
                    </lightning-combobox>
                </div>
                <div class="filter-item">
                    <div class="search-input-wrapper">
                        <lightning-input 
                            type="search" 
                            label="Search value"
                            placeholder="Enter search value..." 
                            onchange={handleSearchChange}
                            value={searchTerm}
                            disabled={isSearchDisabled}
                            class="custom-search-input">
                        </lightning-input>
                    </div>
                </div>
            </div>

            <div class="search-button-container">
                <lightning-button 
                    label="Search" 
                    variant="brand" 
                    onclick={handleSearchAction} 
                    disabled={isSearchDisabled}
                    class="search-button">
                </lightning-button>
            </div>

            <!-- Tabla de Resultados -->
            <template if:true={hasResults}>
                <div class="results-section">
                    <div class="results-table-wrapper">
                        <lightning-datatable
                            key-field="ssot__Id__c"
                            data={searchResults}
                            columns={columns}
                            max-row-selection="1"
                            onrowselection={handleRowSelection}
                            class="custom-datatable">
                        </lightning-datatable>
                    </div>
                </div>
            </template>

            <template if:true={noResults}>
                <div class="no-results-message">
                    <lightning-icon icon-name="utility:info" size="small" class="info-icon"></lightning-icon>
                    <span>No se encontraron perfiles para los criterios seleccionados.</span>
                </div>
            </template>

            <template if:true={isSearching}>
                <div class="spinner-container">
                    <lightning-spinner alt-text="Searching..." size="medium"></lightning-spinner>
                </div>
            </template>
        </div>
    </div>
</template>